import{v as h,o as d,c as m,G as f,t as p,b as y,g as O,l as a,a as u,J as Z,H as _,k as C}from"./runtime-dom.esm-bundler.d8cc9f6e.js";import{i as z,k as G,l as J,b as K,u as Q,j as X}from"./index.1916c442.js";import{u as Y}from"./PostTypes.8f22f5d2.js";import{a as $,S as ee,c as te}from"./Statistic.dedd4ba7.js";import{u as se}from"./WpTable.2bfe12a8.js";import{l as oe}from"./license.902e841d.js";import{n as A}from"./numbers.9fc174f3.js";import{_ as ie}from"./ScoreButton.1c6d94fe.js";import{C as re}from"./Table.af46d4a1.js";import{C as ne}from"./Index.daad859b.js";import{D}from"./datetime.f197aeae.js";import{q as ae}from"./vue3-apexcharts.6f6042eb.js";import"./translations.8804e7f4.js";import{_ as j}from"./_plugin-vue_export-helper.eefbdd86.js";import{_ as n,s as B}from"./default-i18n.20001971.js";import{_ as le}from"./IndexStatus.813aa330.js";const R=void 0,ce={components:{apexchart:ae},props:{points:{type:Object,required:!0},peak:{type:Number,default(){return 0}},recovering:{type:Boolean,default(){return!1}},height:{type:Number,default(){return 50}}},data(){return{strings:{recovering:n("Slowly Recovering",R),peak:n("Peak",R)}}},computed:{getSeries(){const s=this.points,i=[];return Object.keys(s).forEach(r=>{i.push({x:r,y:s[r]})}),[{data:i}]},chartOptions(){const s=this.peak;return{colors:[function({value:i}){return i===s?"#005AE0":"#99C2FF"}],chart:{type:"bar",sparkline:{enabled:!0},zoom:{enabled:!1},toolbar:{show:!1},parentHeightOffset:0,background:"#fff"},grid:{show:!1,padding:{top:2,right:2,bottom:0,left:2}},plotOptions:{bar:{columnWidth:"85%",barHeight:"100%"}},fill:{type:"solid"},tooltip:{enabled:!0,x:{show:!0,formatter:i=>D.fromFormat(i,"yyyy-MM").setZone(D.zone).toLocaleString({month:"long",year:"numeric"})},y:{formatter:i=>{const r=B(n("%1$s points",R),A.numberFormat(i,0));let t="";return i===s&&(t=`<span class="peak">${this.strings.peak}</span>`),r+t}},marker:{show:!1}}}}}},pe={class:"aioseo-graph-decay"},de={key:0,class:"aioseo-graph-decay-recovering"};function ue(s,i,r,t,o,c){const g=h("apexchart");return d(),m("div",pe,[f(g,{width:"100%",height:r.height,ref:"apexchart",options:c.chartOptions,series:c.getSeries,class:"aioseo-graph-decay-chart"},null,8,["height","options","series"]),r.recovering?(d(),m("div",de,p(o.strings.recovering),1)):y("",!0)])}const he=j(ce,[["render",ue]]),fe={};function ge(s,i){return d(),m("div")}const me=j(fe,[["render",ge]]),l=void 0,be={setup(s){const{editPost:i,viewPost:r}=Y(),t=z(),o=({name:x,selectedValue:W})=>{b[x]=W},c=()=>{b.value.postType="",o({name:"postType",selectedValue:""})},g=x=>{if(typeof t[s.updateAction]=="function")return t[s.updateAction](x)},b=O({}),P=O(!1),{openPostDetail:S,orderBy:F,orderDir:T,processFilter:v,resultsPerPage:e}=$({processFilterTable:x=>E(x),showUpsell:P}),k="searchStatisticsSeoStatistics",w="aioseo-search-statistics-post-table",{filter:I,pageNumber:U,processAdditionalFilters:L,processChangeItemsPerPage:N,processFilterTable:E,processPagination:H,processSearch:V,processSort:M,searchTerm:q}=se({changeItemsPerPageSlug:k,fetchData:g,orderBy:F,orderDir:T,resetSelectedFilters:c,resultsPerPage:e,selectedFilters:b,tableId:w});return{changeItemsPerPageSlug:k,editPost:i,filter:I,licenseStore:G(),links:J,openPostDetail:S,optionsStore:K(),orderBy:F,orderDir:T,pageNumber:U,processAdditionalFilterOptionSelected:o,processAdditionalFilters:L,processChangeItemsPerPage:N,processFilter:v,processPagination:H,processSearch:V,processSort:M,rootStore:Q(),searchStatisticsStore:t,searchTerm:q,selectedFilters:b,settingsStore:X(),showUpsell:P,tableId:w,viewPost:r}},components:{CoreScoreButton:ie,CoreWpTable:re,Cta:ne,GraphDecay:he,IndexStatus:le,ObjectActions:me,Statistic:ee},props:{posts:Object,isLoading:Boolean,showHeader:{type:Boolean,default(){return!0}},showTableFooter:Boolean,showItemsPerPage:Boolean,columns:{type:Array,default(){return["postTitle","seoScore","clicks","impressions","position"]}},appendColumns:{type:Object,default(){return{}}},defaultSorting:{type:Object,default(){return{}}},initialFilter:{type:String,default(){return""}},updateAction:{type:String,default(){return"updateSeoStatistics"}}},data(){return{numbers:A,sortableColumns:[],strings:{position:n("Position",l),ctaButtonText:n("Unlock Post Tracking",l),ctaHeader:B(n("Post Tracking is a %1$s Feature",l),"PRO")},license:oe}},watch:{isLoading(s){s||this.$nextTick(()=>{this.loadInspectionResult()})}},computed:{getFilters(){return this.searchStatisticsStore.shouldShowSampleReports?[]:this.posts.filters},allColumns(){var r,t;const s=te(this.columns),i=((t=(r=this.posts)==null?void 0:r.filters)==null?void 0:t.find(o=>o.active))||{};return this.appendColumns[i.slug||"all"]&&s.push(this.appendColumns[i.slug||"all"]),s.map(o=>(o.endsWith("Sortable")&&(o=o.replace("Sortable",""),this.sortableColumns.push(o)),o))},tableColumns(){return[{slug:"row",label:"#",width:"40px"},{slug:"postTitle",label:n("Title",l),width:"100%"},{slug:"seoScore",label:n("TruSEO Score",l),width:"130px"},{slug:"indexStatus",label:n("Indexed",l),width:"80px",coreFeature:"index-status"},{slug:"clicks",label:n("Clicks",l),width:"80px"},{slug:"impressions",label:n("Impressions",l),width:"110px"},{slug:"position",label:n("Position",l),width:"90px"},{slug:"lastUpdated",label:n("Last Updated On",l),width:"160px"},{slug:"decay",label:n("Loss",l),width:"140px"},{slug:"decayPercent",label:n("Drop (%)",l),width:"120px"},{slug:"performance",label:n("Performance Score",l),width:"150px"},{slug:"diffDecay",label:n("Diff",l),width:"95px"},{slug:"diffPosition",label:n("Diff",l),width:"80px"}].filter(s=>s.coreFeature&&((!this.rootStore.isPro||this.licenseStore.isUnlicensed)&&!this.searchStatisticsStore.shouldShowSampleReports||!this.license.hasCoreFeature("search-statistics",s.coreFeature)&&!this.searchStatisticsStore.shouldShowSampleReports)?!1:s.slug==="seoScore"?this.optionsStore.options.advanced.truSeo:this.allColumns.includes(s.slug)).map(s=>(s.sortable=this.isSortable&&this.sortableColumns.includes(s.slug),s.sortable&&(s.sortDir=s.slug===this.orderBy?this.orderDir:"asc",s.sorted=s.slug===this.orderBy),s))},isSortable(){return this.filter==="all"&&this.rootStore.isPro&&!this.licenseStore.isUnlicensed}},methods:{loadInspectionResult(){var r;if(!((r=this.posts)!=null&&r.rows)||this.searchStatisticsStore.quotaExceeded.urlInspection)return;const s=Object.values(this.posts.rows),i=s.filter(t=>{var o;return!t.inspectionResult||((o=t.inspectionResult)==null?void 0:o.length)===0});i.length&&(i.forEach(t=>{const o=s.find(c=>c.page===t.page);o&&(o.inspectionResultLoading=!0)}),this.searchStatisticsStore.getInspectionResult({paths:i.map(t=>t.page)}).then(t=>{i.forEach(o=>{const c=s.find(g=>g.page===o.page);c&&(c.inspectionResult=t[o.page],c.inspectionResultLoading=!1)})}))}},mounted(){var s,i;this.initialFilter&&this.processFilter({slug:this.initialFilter}),this.loadInspectionResult(),this.orderBy=((s=this.defaultSorting)==null?void 0:s.orderBy)||this.orderBy,this.orderDir=((i=this.defaultSorting)==null?void 0:i.orderDir)||this.orderDir}},Se={class:"aioseo-search-statistics-post-table"},_e={class:"object-row"},ye={class:"object-title"},Pe=["onClick"],ke={key:1,class:"object-title"},we={key:0,class:"row-actions"},xe=["href"],Fe=["href"];function Te(s,i,r,t,o,c){const g=h("object-actions"),b=h("core-score-button"),P=h("index-status"),S=h("statistic"),F=h("graph-decay"),T=h("cta"),v=h("core-wp-table");return d(),m("div",Se,[f(v,{ref:"table",class:"posts-table",id:t.tableId,columns:c.tableColumns,rows:Object.values(r.posts.rows),totals:r.posts.totals,filters:c.getFilters,"additional-filters":r.posts.additionalFilters,"selected-filters":t.selectedFilters,loading:r.isLoading,"initial-page-number":t.pageNumber,"initial-search-term":t.searchTerm,"initial-items-per-page":t.settingsStore.settings.tablePagination[t.changeItemsPerPageSlug],"show-header":r.showHeader,"show-bulk-actions":!1,"show-table-footer":r.showTableFooter,"show-items-per-page":r.showItemsPerPage&&!t.searchStatisticsStore.shouldShowSampleReports,"show-pagination":"","blur-rows":t.showUpsell,onFilterTable:t.processFilter,onProcessAdditionalFilters:t.processAdditionalFilters,onAdditionalFilterOptionSelected:t.processAdditionalFilterOptionSelected,onPaginate:t.processPagination,onProcessChangeItemsPerPage:t.processChangeItemsPerPage,onSearch:t.processSearch,onSortColumn:t.processSort},{row:a(({index:e})=>[u("div",_e,p(e+1),1)]),postTitle:a(({row:e})=>{var k,w;return[u("div",ye,[e.objectId&&e.objectType==="post"&&t.searchStatisticsStore.isConnected?(d(),m("a",{key:0,href:"#",onClick:Z(I=>t.openPostDetail(e),["prevent"])},p(e.objectTitle),9,Pe)):(d(),m("span",ke,p(e.objectTitle),1))]),f(g,{row:e},null,8,["row"]),e.objectId&&e.objectType==="post"?(d(),m("div",we,[u("span",null,[u("a",{class:"view",href:e.context.permalink,target:"_blank"},[u("span",null,p(t.viewPost((k=e.context.postType)==null?void 0:k.singular)),1)],8,xe),_(" | ")]),u("span",null,[u("a",{class:"edit",href:e.context.editLink,target:"_blank"},[u("span",null,p(t.editPost((w=e.context.postType)==null?void 0:w.singular)),1)],8,Fe)])])):y("",!0)]}),seoScore:a(({row:e})=>[e.seoScore?(d(),C(b,{key:0,class:"table-score-button",score:e.seoScore},null,8,["score"])):y("",!0)]),indexStatus:a(({row:e})=>[f(P,{result:e.inspectionResult,loading:e.inspectionResultLoading},null,8,["result","loading"]),f(P,{result:e.inspectionResult,loading:e.inspectionResultLoading},null,8,["result","loading"])]),clicks:a(({row:e})=>[_(p(o.numbers.compactNumber(e.clicks)),1)]),impressions:a(({row:e})=>[_(p(o.numbers.compactNumber(e.impressions)),1)]),position:a(({row:e})=>[_(p(Math.round(e.position).toFixed(0)),1)]),lastUpdated:a(({row:e})=>[_(p(e.context.lastUpdated||"-"),1)]),decay:a(({row:e})=>[f(S,{type:"decay","show-difference":!1,total:e.decay,showZeroValues:!0,class:"no-margin"},null,8,["total"])]),decayPercent:a(({row:e})=>[f(S,{type:"decayPercent","show-difference":!1,total:e.decayPercent,showZeroValues:!0,class:"no-margin"},null,8,["total"])]),performance:a(({row:e})=>[f(F,{points:e.points,peak:e.peak,recovering:e.recovering,height:38},null,8,["points","peak","recovering"])]),diffPosition:a(({row:e})=>[e.difference.comparison?(d(),C(S,{key:0,type:"position","show-original":!1,difference:e.difference.position,"tooltip-offset":"-100px,0"},null,8,["difference"])):y("",!0)]),diffDecay:a(({row:e})=>[e.difference.comparison?(d(),C(S,{key:0,type:"diffDecay","show-original":!1,difference:e.difference.decay,"tooltip-offset":"-100px,0"},null,8,["difference"])):y("",!0)]),cta:a(()=>[t.showUpsell?(d(),C(T,{key:0,"cta-link":t.links.getPricingUrl("search-statistics","search-statistics-upsell"),"button-text":o.strings.ctaButtonText,"learn-more-link":t.links.getUpsellUrl("search-statistics","search-statistics-upsell",t.rootStore.isPro?"pricing":"liteUpgrade"),"hide-bonus":!t.licenseStore.isUnlicensed},{"header-text":a(()=>[_(p(o.strings.ctaHeader),1)]),_:1},8,["cta-link","button-text","learn-more-link","hide-bonus"])):y("",!0)]),_:1},8,["id","columns","rows","totals","filters","additional-filters","selected-filters","loading","initial-page-number","initial-search-term","initial-items-per-page","show-header","show-table-footer","show-items-per-page","blur-rows","onFilterTable","onProcessAdditionalFilters","onAdditionalFilterOptionSelected","onPaginate","onProcessChangeItemsPerPage","onSearch","onSortColumn"])])}const qe=j(be,[["render",Te]]);export{qe as P};
